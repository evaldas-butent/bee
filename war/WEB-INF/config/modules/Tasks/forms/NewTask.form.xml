<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form [
  <!ENTITY inline "display: inline-block;">

  <!ENTITY separator "<hr/>">

  <!ENTITY tbl "border-collapse: collapse;">
  <!ENTITY cell "vertical-align: top; padding-bottom: 2px;">
  <!ENTITY col1 "text-align: right; padding-right: 8px; width: 128px;">
  <!ENTITY col3 "text-align: right; padding-left: 8px; padding-right: 8px; width: 128px;">

  <!ENTITY inp2 "width: 160px;">
  <!ENTITY inp2x "width: 500px;">
  <!ENTITY inp2y "width: 500px;">
  <!ENTITY inp3 "width: 70px;margin-left: -75px">

  <!ENTITY dateStyle "&inline; min-width: 90px; max-width: 90px;">
  <!ENTITY timeStyle "&inline; min-width: 60px; max-width: 60px; width: 60px; margin-left: 10px;">
  <!ENTITY timeStep "30">
]>
<f:Form xmlns="http://www.butent.com/widget"
  xmlns:f="http://www.butent.com/form"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  
  name="NewTask" viewName="Tasks" caption="=crmNewTask" width="725" height="700">

  <FlowPanel style="padding: 10px 2px 2px 10px;">
  
    <Table style="&tbl;" cellStyle="&cell;">
      <col index="0" cellStyle="&col1;" />
      <col index="2" cellStyle="&col3;" />

      <row>
        <Label text="=crmTaskTemplate" data="TaskTemplates" />
        <DataSelector viewName="TaskTemplates" choiceColumns="Name" property="Template"
          newRowEnabled="false" style="&inp2;" data="TaskTemplates" />
      </row>

      <row>
        <Label for="Type" />
        <DataSelector source="Type" renderColumns="TypeName" newRowEnabled="true" style="&inp2;"
          disablable="true" />
        <Label for="Priority" />
        <Radio source="Priority" />
      </row>

      <row>
        <Label for="StartTime" />
        <FlowPanel>
          <InputDate name="Start_Date" style="&dateStyle;" required="true" />
          <InputTimeOfDay name="Start_Time" step="&timeStep;" style="&timeStyle;" />
        </FlowPanel>
        <Label for="ExpectedDuration" />
        <InputTime name="ExpectedDuration" source="ExpectedDuration" step="&timeStep;" style="width: 60px;" />
        <Label for="ExpectedExpenses" text="=prjExpenses" style="margin-left:-140px;" />
        <InputDecimal source="ExpectedExpenses" style="&inp3;" disablable="true" scale="2"/>
        <DataSelector source="Currency" for="ExpectedExpenses" newRowEnabled="false" editEnabled="false"
              style="width: 50px;" readOnly="true" />
      </row>

      <row>
        <Label name="EndDateLabel" text="=endingDate" class="bee-required" />
        <FlowPanel>
          <InputDate name="End_Date" style="&dateStyle;" />
          <InputTimeOfDay name="End_Time" step="&timeStep;" style="&timeStyle;" />
        </FlowPanel>
        <Label for="Company" />
        <DataSelector source="Company" editPopup="true" newRowEnabled="false" choiceColumns="Name TypeName" 
            renderColumns="CompanyName CompanyTypeName" style="width: 200px;" />
      </row>

      <row>
        <Label for="Reminder" />
        <DataSelector source="Reminder" renderColumns="ReminderName" newRowEnabled="false"
          style="&inp2;" />
        <Label for="Contact" />
        <DataSelector source="Contact" editPopup="true" newRowEnabled="false" style="width: 200px;"
          renderColumns="ContactFirstName ContactLastName"
          choiceColumns="FirstName LastName CompanyName" options="Company" />
      </row>

      <row>
        <Label for="ReminderTime" />
        <FlowPanel for="ReminderTime">
          <InputDate name="Reminder_Date" style="&dateStyle;" />
          <InputTimeOfDay name="Reminder_Time" step="&timeStep;" style="&timeStyle;" />
        </FlowPanel>
        <cell colSpan="2" horizontalAlignment="left" style="padding-left: 2em;" module="Mail">
          <CheckBox name="Mail" text="=mailNotify" />
        </cell>
      </row>
    </Table>

    &separator;
    <Table style="&tbl;" cellStyle="&cell;">
      <col index="0" cellStyle="&col1;" />
      
      <row>
        <Label for="Summary" />
        <InputText source="Summary" style="&inp2x;" autocomplete="true" visible="true" />
      </row>

      <row for="Description">
        <Label for="Description" />
        <InputArea source="Description" style="&inp2x; height: 60px;" />
      </row>
    </Table>

    &separator;
    <FlowPanel class="flexBox-horizontal-top" data="TaskFiles">
      <Label text="=files" style="&col1; margin-top: 4px;" />
      <FileCollector name="Files" editableColumns="name">
        <face resource="attachment" />
      </FileCollector>
    </FlowPanel>

    &separator;
    <Table style="&tbl;" cellStyle="&cell;">
      <col index="0" cellStyle="&col1;" />

      <row>
        <Label name="ExecutorsLabel" class="bee-required" text="=crmTaskExecutors" />
        <MultiSelector name="Executors"
          viewName="Users" property="Executors" renderColumns="FirstName LastName"
          editPopup="true" newRowEnabled="false" editSource="CompanyPerson" style="&inp2x;"
          label="=crmTaskExecutors" />
      </row>

      <row>
        <Label text="=crmTaskExecutorGroups" />
        <MultiSelector name="UserGroupSettings" viewName="UserGroupSettings"
          property="ExecutorGroups" renderColumns="Name" editPopup="true" newRowEnabled="false"
          style="&inp2y;" label="=crmTaskExecutorGroups" filter="Owner {u} or Visibility 1">
        </MultiSelector>
      </row>

      <row>
        <Label text="=crmTaskObservers" />
        <MultiSelector name="Observers" viewName="Users" property="Observers" renderColumns="FirstName LastName"
          editPopup="true" newRowEnabled="false" editSource="CompanyPerson" style="&inp2x;"
          label="=crmTaskObservers" />
      </row>

      <row>
        <Label text="=crmTaskObserverGroups" />
        <MultiSelector name="ObserverGroups" viewName="UserGroupSettings" property="ObserverGroups" renderColumns="Name"
          editPopup="true" newRowEnabled="false" style="&inp2y;" label="=crmTaskObserverGroups"
          filter="Owner {u} or Visibility 1" />
      </row>
      
      <row module="Projects" data="Projects" >
        <Label text="=project" name="ProjectLabel"/>
        <DataSelector source="Project" style="&inp2x;" disablable="true" readOnly="true" 
        editPopup="false" />
      </row>         
      <row  module="Projects" data="ProjectStages">
        <Label text="=prjStage" name="ProjectStageLabel"/>
        <DataSelector source="ProjectStage" style="&inp2x;" />
      </row>
    </Table>

    &separator;
    <Label text="=relatedTo" style="font-style: italic; margin-bottom: 2px;" data="Relations" />

    <Table style="&tbl;" cellStyle="&cell;" data="Relations" for="Task">
      <col index="0" cellStyle="&col1;" />
  
      <row data="Relations" for="Company" module="Classifiers.Contacts">
        <Label text="=companies" />
        <MultiSelector viewName="Companies" property="Companies" renderColumns="Name TypeName"
          editPopup="true" newRowEnabled="false" style="&inp2x;" />
      </row>

      <row data="Relations" for="Person" module="Classifiers.Contacts">
        <Label text="=persons" />
        <MultiSelector viewName="Persons" property="Persons" renderColumns="FirstName LastName"
          editPopup="true" newRowEnabled="false" style="&inp2x;" />
      </row>

      <row data="Relations" for="Document" module="Documents">
        <Label text="=documents" />
        <MultiSelector viewName="Documents" property="Documents" renderColumns="Name Number RegistrationNumber"
          editPopup="true" newRowEnabled="false" style="&inp2x;" />
      </row>

      <row data="Relations" for="Appointment" module="Calendar">
        <Label text="=calAppointments" />
        <MultiSelector viewName="Appointments" property="Appointments"
          renderColumns="Summary" choiceColumns="Summary StartDateTime EndDateTime"
          newRowEnabled="true" editPopup="true" style="&inp2x;" />
      </row>

      <row data="Relations" for="Discussion" module="Discussions">
        <Label text="=discussions" />
        <MultiSelector viewName="Discussions" property="Discussions"
          renderColumns="Subject" newRowEnabled="false" editPopup="true" style="&inp2x;" />
      </row>

      <row data="Relations" for="ServiceObject" module="Service">
        <Label text="=svcObjects" />
        <MultiSelector viewName="ServiceObjects" property="ServiceObjects"
          renderColumns="Address" choiceColumns="Address CustomerName"
          newRowEnabled="false" editPopup="true" style="&inp2x;" />
      </row>

      <row data="Relations" for="Projects" module="Projects">
        <Label text="=projects" />
        <MultiSelector viewName="Projects" property="Projects"
          renderColumns="Name" choiceColumns="Name"
          newRowEnabled="false" editPopup="true" style="&inp2x;" />
      </row>

      <row data="Relations" for="Relation">
        <Label text="=crmTasks" />
        <MultiSelector viewName="Tasks" property="Tasks" 
          renderColumns="Id Summary ExecutorFirstName ExecutorLastName"
          choiceColumns="Id Summary ExecutorFirstName ExecutorLastName StartTime FinishTime"
          newRowEnabled="false" editPopup="true" style="&inp2x;" />
        </row>
    </Table>

  </FlowPanel>
</f:Form>