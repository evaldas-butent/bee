<?xml version="1.0" encoding="UTF-8"?>
<Table xmlns="http://www.butent.com/table"

  name="TradeActs"
  idName="TradeActID"
  >
  <Fields>
    <Relation name="Name" relation="TradeActNames" label="=tradeActName" />
    <Relation name="Contract" relation="Documents" label="=trdContract" />

    <DateTime name="Date" notNull="true" defExpr="CURRENT_TIME" label="=taDate" />
    <DateTime name="Until" label="=taUntil" />

    <Relation name="Series" relation="TradeSeries" label="=trdSeries" />
    <String name="Number" precision="30" label="=number" />

    <Enum name="Kind" key="TradeActKind" notNull="true" label="=taKind" />
    <Relation name="Operation" relation="TradeOperations" label="=trdOperation" />

    <Relation name="Status" relation="TradeStatuses" label="=status" />

    <Relation name="Company" relation="Companies" label="=client" />
    <Relation name="Contact" relation="CompanyPersons" label="=contact" />
    <Relation name="Object" relation="CompanyObjects" label="=object" />
    <Relation name="Manager" relation="Users" label="=manager" defExpr="CURRENT_USER" />

    <Relation name="Currency" relation="Currencies" notNull="true" defExpr="MAIN_CURRENCY"
      label="=currency" />

    <Relation name="Vehicle" relation="Vehicles" label="=trVehicle" />
    <Relation name="InputVehicle" relation="TradeActVehicles" label="=trVehicle" />
    <Relation name="Driver" relation="Drivers" label="=trdDriver" />
    <Relation name="InputDriver" relation="TradeActDrivers" label="=trdDriver" />

    <Text name="Notes" label="=notes" />

    <Relation name="Parent" relation="TradeActs" label="=taParent" />
    <Relation name="ContinuousAct" relation="TradeActs" label="=taKindContinuous" cascade="SET_NULL"/>
    <Relation name="ReturnAct" relation="TradeActs" label="=taKindReturn" cascade="SET_NULL" />
    <Relation name="RentProject" relation="TradeActs" label="Nuomos projektas" />

    <String name="RegistrationNo" label="=taRegistrationNo" precision="30" />
    <Numeric name="RemainItemQuantity" precision="12" scale="3" defValue="NULL" label="=taQuantityRemained" />
  </Fields>
  <Constraints>
    <Unique fields="Series Number" />
  </Constraints>
  <Indexes>
    <Index unique="true">
      <PostgreSql>((CASE "RegistrationNo" WHEN '0' THEN NULL ELSE "RegistrationNo" || ' '
        || COALESCE("Series", 0) END))
      </PostgreSql>
      <MsSql></MsSql>
      <Oracle></Oracle>
    </Index>
  </Indexes>
</Table>