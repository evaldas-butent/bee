<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form [
    <!ENTITY summary "font-size: large; margin-left: 1em; margin-bottom: 5px; outline: none;">
    <!ENTITY table "border-collapse: collapse;">
    <!ENTITY colLabel "text-align: right; padding-left: 1em; padding-right: 1em; ">
    <!ENTITY cols '<col index="0" cellStyle="&colLabel;" /><col index="2" cellStyle="&colLabel;" /><col index="4" cellStyle="&colLabel;" />'>
    <!ENTITY cells "vertical-align: top; padding-bottom: 3px;">
    <!ENTITY separator "<hr/>">
    <!ENTITY decimal "width:7em;">
    <!ENTITY unit "display:inline-block; width:5em; margin-left:5px;">
    ]>
<f:Form xmlns="http://www.butent.com/widget"
        xmlns:f="http://www.butent.com/form" xmlns:ui="http://www.butent.com/ui"

        name="ShipmentRequest" viewName="ShipmentRequests"
        showRowId="true" width="70" widthUnit="%" height="80" heightUnit="%"
>
  <f:properties jasperReports="OrderContract" />

  <FlowPanel>
    <FlowPanel name="Status" >
      <Table kind="custom" style="&table; margin-top:10px;" cellStyle="&cells;">
        &cols;
        <row>
          <Label for="Locale" />
          <TextLabel source="Locale" style="font-weight:bold;" />
          <FlowPanel name="OrderID" style="cursor:pointer; font-weight:bold; color:blue;" />
          <Label />
          <Label text="=customerPrice" />
          <MoneyLabel property="Income" style="font-weight: bold;" />
          <Label text="=vat" style="margin-left: 5px;" />
          <MoneyLabel property="Vat" style="font-weight: bold;" />
        </row>
      </Table>
      <Table kind="custom">
        &cols;
        <row>
          <Label for="Status" />
          <TextLabel source="Status" style="font-weight:bold;" />
          <TextLabel source="LossReason" style="color:red; white-space:pre-wrap;" />
        </row>
      </Table>
      &separator;
    </FlowPanel>

    <Details open="true">
      <Summary text="=trRequestShipmentInfo" style="&summary;" />

      <Table kind="controls" style="&table;" cellStyle="&cells;">
        &cols;

        <row>
          <Label for="Expedition" class="bee-required" />
          <DataSelector source="Expedition" required="true" filter="SelfService"
                        renderColumns="ExpeditionType" order="SelfService, Name"
                        newRowEnabled="false" choiceColumns="Name NameEn NameRu">
            <ui:rowRenderer type="join" separator="/" />
          </DataSelector>
          <cell rowSpan="2">
            <Label for="CargoNotes" />
          </cell>
          <cell rowSpan="2">
            <InputArea source="CargoNotes" visibleLines="4" style="width:200px;" />
          </cell>
        </row>

        <row>
          <Label for="ShippingTerm" class="bee-required" />
          <FlowPanel>
            <DataSelector source="ShippingTerm" required="true" filter="SelfService"
                          order="SelfService, Name" newRowEnabled="false" />
            <FaLabel name="Incoterms" char="question_circle" disablable="false"
              style="display: inline-block; margin-left: 5px;"/>
          </FlowPanel>
        </row>

        <row>
          <CheckBox source="CustomsBrokerage" title="=trRequestCustomsBrokeragePlaceholder" />
          <cell horizontalAlignment="right">
            <CheckBox source="FreightInsurance" title="=trRequestFreightInsurancePlaceholder" />
          </cell>
          <Label for="Value" name="ValueLabel" />
          <FlowPanel>
            <InputMoney source="Value" style="&decimal;" />
            <DataSelector source="ValueCurrency" newRowEnabled="false" editEnabled="false"
                          placeholder="=currencyShort" style="&unit;" filter="SelfService" />
          </FlowPanel>
        </row>
      </Table>
    </Details>
    &separator;

    <Details open="true">
      <Summary text="=trRequestCargoInfo" style="&summary;" />

      <FlowPanel class="flexBox-horizontal">
        <Label for="Description" style="&colLabel;"/>
        <InputArea source="Description" visibleLines="1" style="width:600px;" />
      </FlowPanel>

      <Table kind="controls" style="&table;" cellStyle="&cells;">
        &cols;

        <row>
          <Label for="Weight" name="WeightLabel" />
          <FlowPanel>
            <InputDecimal source="Weight" style="&decimal;" />
            <DataSelector source="WeightUnit" style="&unit;" />
          </FlowPanel>
          <Label for="Height" />
          <InputDecimal source="Height" style="&decimal;" />
          <text/>
          <CheckBox source="Dangerous" />
        </row>

        <row>
          <Label for="Volume" />
          <FlowPanel>
            <InputDecimal source="Volume" style="&decimal;" />
            <DataSelector source="VolumeUnit" style="&unit;" />
          </FlowPanel>
          <Label for="Width" />
          <InputDecimal source="Width" style="&decimal;" />
          <text/>
          <CheckBox source="Outsized" />
        </row>

        <row>
          <Label for="Quantity" />
          <FlowPanel>
            <InputDecimal source="Quantity" style="&decimal;" />
            <DataSelector source="QuantityUnit" style="&unit;" />
          </FlowPanel>
          <Label for="Length" />
          <InputDecimal source="Length" style="&decimal;" />
          <text />
          <FlowPanel name="PartialToggle" class="flexBox-horizontal" />
        </row>

        <row>
          <text />
          <text />
          <Label for="LDM" />
          <InputDecimal source="LDM" style="&decimal;" />
        </row>
      </Table>
    </Details>
    &separator;

    <Details open="true">
      <Summary text="=cargoInformation" style="&summary;" />
      <ChildGrid name="CargoLoadingUnbound" relColumn="Cargo" source="Cargo" />
      <ChildGrid name="CargoUnloadingUnbound" relColumn="Cargo" source="Cargo" />
    </Details>
    &separator;

    <FlowPanel name="Manager">
      <HorizontalPanel>
        <Label for="Manager" />
        <DataSelector source="Manager" renderColumns="ManagerFirstName ManagerLastName"
                      newRowEnabled="false" editSource="ManagerPerson" style="width:15em;" />
      </HorizontalPanel>
      &separator;
    </FlowPanel>

    <Details name="AdditionalInfo" open="true">
      <Summary text="=trRequestAdditionalInfo" style="&summary;" />

      <Table kind="controls" style="&table;" cellStyle="&cells;">
        &cols;

        <row>
          <Label for="Vehicle" />
          <InputText source="Vehicle" />
          <cell rowSpan="2">
            <Label for="Notes" />
          </cell>
          <cell rowSpan="2">
            <InputArea source="Notes" visibleLines="4" style="width:200px;" />
          </cell>
        </row>

        <row>
          <Label for="Driver" />
          <InputText source="Driver" />
        </row>

        <row>
          <Label for="Host" />
          <TextLabel source="Host" />
          <Label for="Agent" />
          <TextLabel source="Agent" />
        </row>
      </Table>
      &separator;
    </Details>

    <TabbedPages style="height:300px;">
      <dynStyle>
        <ui:inline>display:none;</ui:inline>
        <ui:expression>!(rowId>0)</ui:expression>
      </dynStyle>
      <page>
        <text>=files</text>
        <ChildGrid name="CargoFiles" relColumn="Cargo" source="Cargo" />
      </page>
      <page>
        <text>=mails</text>
        <ChildGrid name="RelatedMessages" relColumn="ShipmentRequest" />
      </page>
      <page>
        <text>=trOrderCargoServices</text>
        <ChildGrid name="CargoIncomes" relColumn="Cargo" source="Cargo" />
      </page>
    </TabbedPages>

    <FlowPanel class="tr-shipmentRequest-Date flexBox-horizontal">
      <Label for="Date" />
      <DateTimeLabel source="Date" style="margin-left: 10px;"/>
    </FlowPanel>
  </FlowPanel>
</f:Form>
