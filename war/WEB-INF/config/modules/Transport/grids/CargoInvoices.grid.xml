<?xml version="1.0" encoding="UTF-8"?>
<Grid xmlns="http://www.butent.com/grid"
  xmlns:ui="http://www.butent.com/ui"

  name="CargoInvoices" viewName="CargoInvoices"
  editShowId="true" flexGrow="1"
  disabledActions="add"
  caption="=trInvoices"
  filter="!(Proforma)"
  >
  <columns>
    <SelectionColumn name="Select" caption="-" width="20" />
    <IdColumn name="ID" />
    <DataColumn name="Date" caption="=date" />
    <DataColumn name="Number" />
    <CalcColumn name="Invoice" type="string" caption="=invoiceNumber" 
      searchBy="InvoicePrefix InvoiceNumber">
      <render>
        <ui:function>
          if (!row.InvoicePrefix) {
            return row.InvoiceNo;
          } else if(!row.InvoiceNo) {
            return row.InvoicePrefix;
          } else {
            return row.InvoicePrefix + " " + row.InvoiceNo;
          }
        </ui:function>
      </render>
    </CalcColumn>
    <RelColumn name="Customer" caption="=trCustomer" />
    <RelColumn name="Payer" caption="=payer" />
    <DataColumn name="Amount" />
    <DataColumn name="CurrencyName" />
    <DataColumn name="Term" />
    
    <DataColumn name="PaymentTime" />
    <DataColumn name="Paid" />

    <CalcColumn name="Debt" type="decimal" scale="2" caption="=trDept">
      <render>
        <ui:function>
          if (!row.Paid) {
            return row.Amount;
          } else if (row.Paid == row.Amount) {
            return null;
          } else {
            return row.Amount - row.Paid;
          }
        </ui:function>
      </render>
    </CalcColumn>

    <DataColumn name="Vehicle" />
    <DataColumn name="Driver" />
    <DataColumn name="Exported" />
  </columns>

  <rowStyle>
    <ui:inline>="color:red"</ui:inline>
    <ui:expression>row.Paid &lt; row.Amount</ui:expression>
  </rowStyle>
</Grid>
